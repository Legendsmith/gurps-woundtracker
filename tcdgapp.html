<!DOCTYPE html>
<html manifest=tcdgapp.manifest>
<head>
  <meta charset="UTF-8">
  <title>Technicolor Dream GURPS Sheet</title>
  <link rel="stylesheet" type="text/css" href="appstyle.css">
  <script>
  //analytics
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-87618703-1', 'auto');
  ga('send', 'pageview');
</script>
<script type="text/javascript" src="damagetables.json"></script>
<script type="text/javascript" src="patterns.js"></script>
<script type="text/javascript" src="lz-string.min.js"></script>
</head>
<body>
<div id="main">
  <div id="tabwrap"><ul class="tab">
  <li><a href="javascript:void(0)" class="tablinks" onclick="openTab(event, 'controls')" id="defaultOpen">Characters</a></li>
  <li><select id="sl_namelist" style="width:120px">Character</select></li>
  <li><a href="javascript:void(0)" class="tablinks" onclick="openTab(event, 'lastgasp')">Last Gasp</a></li>
  <li><a href="javascript:void(0)" class="tablinks" onclick="openTab(event, 'wounds')">Wounds & HP</a></li>
  <li><button id="btn_save">Save</button></li>
  <li><button id="btn_load">Load</button></li>
  </div>
</ul>
<div id="lastgasp" class="tabcontent">
  <h1><span class="he">G</span><span class="he">U</span><span class="he">R</span><span class="he">P</span><span class="he">S</span> Last Gasp Assistant</h1>
  <span class="subnote"> <input type="checkbox" id="cb_rnd">Use <a href="https://www.random.org/">Random.org</a> for dice.</input> <input type="checkbox" id="cb_highres"></input><div class="tooltip">High Resoluton stat loss.<span class="tooltiptext">Normally stat loss increases by -1 per 20% FP lost, for -10 at -1×FP. Enabling this option turns it to 10% per 20% FP lost, so that high stat characters will still reach 0 DX, IQ, etc at -1×FP</span></div> <input type="checkbox" id="cb_cap"><div class="tooltip">Cap penalties at -5 or -50%.<span class="tooltiptext">With this option stat loss will not exceed -5, or -50% of the base stat when using High Resolution stat loss.</span></div></input>  </span>
<div style="float:left;width:295px">
<h3 id="txt_name"></br></h3>
<h3>
  <button class="fancybtn" id="btn_app1">+1</button>
  <button class="fancybtn" id="btn_apm1">-1</button>
  <span id="txt_AP">X/X AP</span>
  <input class=insm type="number" id="in_aps" value =0></br>
</h3>
<h3>
  <button class="fancybtn" id="btn_fpp1">+1</button>
  <button class="fancybtn" id="btn_fpm1">-1</button>
  <span id="txt_FP">X/X FP</span>
  <input class=insm type="number" id="in_fps" value =0>
</br>
</h3>
<button class="fancybtn" id="btn_apf">Fill AP</button> <button class="fancybtn" id="btn_fpf">Fill FP</button> <button class="fancybtn" id="btn_updt">Update</button>
<h4>Stats and Impairment</h4>
<span id = "txt_st">|</span></br>
<span id = "txt_dx">|</span></br>
<span id = "txt_iq">|</span></br>
<span id = "txt_ht">|</span></br>
<span id = "txt_pen">|</span></br>
<span id = "txt_lif">|</span> // <input class=insm type="number" id="in_enc" value = 0>lbs Carried</input></br>
<span id ="txt_mov">|</span></br>
<span id = "txt_enc">|</span></br><hr>
<span id = "txt_dmg">|</span></br>
<span id = "txt_status">|</br>|</span></br></div>

<div style="float:right;width:295px;background-color:#e6e6ee;border-radius:10px;padding:5px;margin-top:10px;">
  <h3>AP Quick Reference</h3>
  <h4 class="tooltip" style="font-size:14">One AP Actions
  <ul class="tooltiptext">
    <li>Active Defense</li>
    <li>Melee Attack</li>
    <li>Draw a Bow/Crossbow</li>
    <li>Defensive Attack</li>
    <li>Fast Draw/Quick Ready</li>
    <li>Feint</li>
    <li>Change Facing (1 per 60°)</li>
    <li>Change Posture</li>
  </ul></span></h4> <button class="fancybtn" id="btn_one">Spend 1 AP</button></br>
  <h4 class="tooltip" style="font-size:14">Two AP Actions<ul class="tooltiptext">
    <li>Melee All-out Attack</li>
    <li>Committed Attack</li>
  </ul></h4> <button class="fancybtn" id="btn_two">Spend 2 AP</button><br>
  
  <hr>
  <b class="tooltip">Movement Calculator<span class="tooltiptext">If you haven't taken your free step yet, don't include that on the distance slider.</span></b></br>
<!-- <input type="checkbox" id="cb_mcv"><span class="smallnote">Variant Move: Acceleration</span></input></br> -->
<input type="range" id="rn_mov"><span id="txt_rnmov" step="1"></span></br>
<span class="subnote">This feature is not yet complete!</span>
  <hr>
  Taking injury also reduces AP, but this can be mitigated with a HT Roll.</br>
  <input class=insm type="number" id="in_inj" value =0 min=0> Injury<br>
  <input class=insm type="number" id="in_jcap" value =0 min=0> AP Loss Cap </br><input class=insm type="number" id="in_lossdiv" value=1 min=1> <div class="tooltip">AP Loss Divisor<span class="tooltiptext">This allows setting the injury required per 1 AP lost, as the GM may desire larger monsters and PCs to require heavier blows to properly exhaust them in combat. NOTE: This value is NOT saved per-character.</span> </div><br>
  <button class="fancybtn" id="btn_injury">Roll AP loss/Mitigation from Injury</button></br><span id ="txt_out2"></span></br><hr>
  <b>AP Recovery Events</b></br>

  <p>The <b>next</b> turn after taking one of these manuvers Roll HT (Penalised by Impairment). On a success, recover 1 AP plus 1 per 4 margin of success. No bonus to HT unless otherwise noted.<p>
  <ul>
    <li>Do Nothing, +4 to HT roll</li>
    <li>Evaluate, gives +1 to attack</li>
    <li>Wait, only recovers if not triggered</li>
  </ul>
</div>
<div style="float:left;width:295px;background-color:#ffffff;border-radius:10px;"><div style="padding:10px"><b>AP Recovery</b></br><button class="fancybtn" id="btn_wnd">Spend 1 FP to regain AP</button></br>
  <p class="smallnote" >This regains you 50% of your max HT as AP. If you have the 2nd Wind Advantage, you gain 10% more per level, so use the manual update to reflect this.</p>
  <h3>Recovery Events</h3>
 <button class="fancybtn" id="btn_not">Roll For Recovery (Do Nothing)</button>
 <button class="fancybtn" id="btn_eva">Roll For Recovery (Eval/Wait)</button></br><span id ="txt_out"></span></div></div></div>



<div id="controls" class="tabcontent">
<p> <span class="he">G</span><span class="he">U</span><span class="he">R</span><span class="he">P</span><span class="he">S</span> "The Last Gasp" Assistant is designed for "The Last Gasp" rules found in <a href="http://www.warehouse23.com/products/pyramid-number-3-slash-44-alternate-gurps-ii"> Pyramid 3/44</a>. These rules add excellent depth to combat, but the extra tracking required can be a bit much for some. This small app is designed to make tracking the effects of FP loss and Action points a quick and easy task.</p>
<p>Saving and loading are not currently implimented. You only have to remember your FP and AP anyway. Additional FP and AP, and Move are modifiers, do not enter your base AP, FP, and Move! Only modify those if you have differing attributes from the norm derived from your primary attributes.The dodge penalty from encumberance is <b>NOT</b> incorporated into the displayed dodge in order to prevent ambiguity.</p> <p>The FP bar on the side tracks your current FP. As expected, it decreases when you spend it and show you the stages of fatigue. But when you increase it will show a hatched line pattern, this allows you to see what stage of fatigue you are working through. Once your fatigue returns to maximum, the solid bar will fill again. 
<h4>Enter your character's stats</h4>
<p class="subnote">Basic speed is not shown here, but unless you have a move modifier your basic speed will be the same as your move, except perhaps for a fraction. If you have <i>Fit</i> or <i>Very Fit</i>, recovery times are halved. <i>Unfit</i> and Very Unfit</i> double recovery times. <i>The bonuses from these dis/advantages <b>are</b> taken into account automatically.</i></p>
Name: <input type="text" id="ti_name" maxlength="26" value="default"></input> <button class="fancybtn" id="btn_init">Initialise</button></br>
<div style="width:50%;float:left;"><input class=insm type="number" id="in_HT" value =10> HT</input></br>
<input class=insm type="number" id="in_ST" value =10> ST</input></br>
<input class=insm type="number" id="in_AP" value =0> Additional AP</input></br>
<input class=insm type="number" id="in_FP" value = 0> Additional FP</input> </br><input type="checkbox" id="cb_fit">Fit</input></br><input type="checkbox" id="cb_ufit">Unfit</input></div>

<div style="width:50%;float:left;">
<input class=insm type="number" id="in_DX" value =10> DX</input></br>
<input class=insm type="number" id="in_IQ" value =10> IQ</input></br>
<input class=insm type="number" id="in_mov" value =0> Move Modifier</input></br>
<input class=insm type="number" id="in_dod" value = 0>Dodge Modifier</input></br>
<input type="checkbox" id="cb_vfit">Very Fit</input></br><input type="checkbox" id="cb_vufit">Very Unfit</input>
</div>
<div style="clear:left;"><p style="font-size:10px">If the <i>base</i> level of a stat changes due to magic or some other force, you will need to reinitialise. The exception to this is Weight Carried, that can (and should) be modified on the fly as characters move loads.</p>
<hr></div><div style="clear:left;"></div>
</br>
<div style="clear:left;clear:right;float:left;font-size:10px">Technicolor Dream <span class="he">G</span><span class="he">U</span><span class="he">R</span><span class="he">P</span><span class="he">S</span> created by <a href="mailto:legendsmith.au@gmail.com">Legendsmith</a>. The material presented here is my original creation, intended for use with the <a href="http://www.sjgames.com/gurps/"><b><i><span class="he">G</span><span class="he">U</span><span class="he">R</span><span class="he">P</span><span class="he">S</span></i></b></a> system from <a href="http://www.sjgames.com/">Steve Jackson Games</a>. This material is not official and is not endorsed by Steve Jackson Games.</p><p class="subnote" ><a href="https://github.com/Legendsmith/technicolor-dream-GURPS">Repository on Github</a> <input type="checkbox" id="cb_tcd">Disable Technicolour GURPS </div>
<!--lat gasp-->

</div><div id="page-wrap"><canvas id="display" width="150px" ></canvas></div>
</div>
</body>
<script type="text/javascript" src="main.js"></script>
</html> 
